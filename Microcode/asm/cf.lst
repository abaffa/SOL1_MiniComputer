0001   8000             .org 8000h
0002   8000             
0003   8000             
0004   8000             
0005   8000             IDE_BASE	.equ 	0FFB0h			; IDE BASE
0006   8000             IDE_R0		.equ 	IDE_BASE + 0		; DATA PORT
0007   8000             IDE_R1		.equ 	IDE_BASE + 1		; READ: ERROR CODE, WRITE: FEATURE
0008   8000             IDE_R2		.equ 	IDE_BASE + 2		; NUMBER OF SECTORS TO TRANSFER
0009   8000             IDE_R3		.equ 	IDE_BASE + 3		; SECTOR ADDRESS LBA 0 [0:7]
0010   8000             IDE_R4		.equ 	IDE_BASE + 4		; SECTOR ADDRESS LBA 1 [8:15]
0011   8000             IDE_R5		.equ 	IDE_BASE + 5		; SECTOR ADDRESS LBA 2 [16:23]
0012   8000             IDE_R6		.equ 	IDE_BASE + 6		; SECTOR ADDRESS LBA 3 [24:27 (LSB)]
0013   8000             IDE_R7		.equ 	IDE_BASE + 7		; READ: STATUS, WRITE: COMMAND
0014   8000             
0015   8000             PIO_CONTROL	.equ 0FFB3h
0016   8000             PIO_A		.equ 0FFB0h		
0017   8000             PIO_B		.equ 0FFB1h
0018   8000             PIO_C		.equ 0FFB2h
0019   8000             
0020   8000             
0021   8000             ;PC.7  --> inverter --> IDE bus /RESET
0022   8000             ;PC.6  --> inverter --> IDE bus /RD
0023   8000             ;PC.5  --> inverter --> IDE bus /WR
0024   8000             ;PC.4  --> inverter --> IDE bus /CS1
0025   8000             ;PC.3  --> inverter --> IDE bus /CS0
0026   8000             ;PC.2  -->              IDE bus A2
0027   8000             ;PC.1  -->              IDE bus A1
0028   8000             ;PC.0  -->              IDE bus A0
0029   8000             
0030   8000             
0031   8000             
0032   8000             _IDE:
0033   8000 19 80       	MOV AL, %10000000
0034   8002 3D B3 FF    	mov [PIO_CONTROL], al		; set 8255 mode
0035   8005             
0036   8005             	
0037   8005 19 55       	MOV al, 055H
0038   8007 3D B2 FF    	mov [PIO_C], al			; toggle RD low
0039   800A 19 55       	MOV al, 055H
0040   800C 3D B0 FF    	mov [PIO_A], al			; toggle RD low
0041   800F             
0042   800F 0B          	RET
0043   8010             .end0044   8010             0045   8010             0046   8010             0047   8010             0048   8010             0049   8010             0050   8010             0051   8010             0052   8010             0053   8010             0054   8010             0055   8010             0056   8010             0057   8010             0058   8010             0059   8010             0060   8010             0061   8010             0062   8010             0063   8010             0064   8010             0065   8010             0066   8010             0067   8010             0068   8010             0069   8010             0070   8010             0071   8010             0072   8010             0073   8010             0074   8010             0075   8010             0076   8010             0077   8010             0078   8010             0079   8010             0080   8010             0081   8010             0082   8010             0083   8010             0084   8010             0085   8010             0086   8010             0087   8010             0088   8010             0089   8010             0090   8010             0091   8010             0092   8010             0093   8010             0094   8010             0095   8010             0096   8010             0097   8010             0098   8010             0099   8010             0100   8010             0101   8010             0102   8010             0103   8010             0104   8010             0105   8010             0106   8010             0107   8010             0108   8010             0109   8010             0110   8010             0111   8010             0112   8010             0113   8010             0114   8010             0115   8010             0116   8010             0117   8010             0118   8010             0119   8010             0120   8010             0121   8010             0122   8010             0123   8010             0124   8010             0125   8010             0126   8010             0127   8010             0128   8010             0129   8010             0130   8010             0131   8010             0132   8010             0133   8010             0134   8010             0135   8010             0136   8010             0137   8010             0138   8010             0139   8010             0140   8010             0141   8010             0142   8010             0143   8010             0144   8010             0145   8010             0146   8010             0147   8010             0148   8010             0149   8010             0150   8010             0151   8010             0152   8010             0153   8010             0154   8010             0155   8010             0156   8010             0157   8010             0158   8010             0159   8010             0160   8010             0161   8010             0162   8010             0163   8010             0164   8010             0165   8010             0166   8010             0167   8010             0168   8010             0169   8010             tasm: Number of errors = 0
