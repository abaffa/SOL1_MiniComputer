0001   0000             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0002   0000             ; PROCESS 1 DATA
0003   0000             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0004   0000             .include bios.exp
0001+  0000             ide_serv         .EQU  $0003
0002+  0000             kernel_serv      .EQU  $0000
0003+  0000             rtc_serv         .EQU  $0001
0004+  0000             rd_tick          .EQU  $0007
0005+  0000             uart_serv        .EQU  $0002
0006+  0000             wr_tick          .EQU  $0008
0007+  0000             xput_u16         .EQU  $0004
0008+  0000             xget_u16         .EQU  $0005
0009+  0000             xput_u8          .EQU  $0006
0005   0000             .org 0
0006   0000             
0007   0000             PROCESS_1:
0008   0000 FD 47 FF FF 	mov sp, $FFFF
0009   0004 FD 49 FF FF 	mov bp, $FFFF
0010   0008 52 02 00    	sub sp, 2
0011   000B 10 00 00    	mov a, 0
0012   000E 45 FF FF    	mov [bp + -1], a
0013   0011             		
0014   0011             	
0015   0011             main_menu_loop:
0016   0011 0C          	lodstat
0017   0012 87 FD       	and al, %11111101
0018   0014 0D          	stostat
0019   0015             	
0020   0015 17 FF FF    	mov a, [bp + -1]
0021   0018 77          	inc a
0022   0019 45 FF FF    	mov [bp + -1], a
0023   001C 05 08       	syscall wr_tick
0024   001E             	
0025   001E 0C          	lodstat
0026   001F 8B 02       	or al, %00000010
0027   0021 0D          	stostat
0028   0022             		
0029   0022             	
0030   0022 0A 11 00    	jmp main_menu_loop
0031   0025             		
0032   0025             
0033   0025             
0034   0025             
0035   0025             
0036   0025             	
0037   0025             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0038   0025             ; PRINT NULL TERMINATED STRING
0039   0025             ; pointer in D
0040   0025             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0041   0025             puts:
0042   0025 E1          	pushf
0043   0026 D7          	push a
0044   0027 DA          	push d
0045   0028             puts_L1:
0046   0028 1E          	mov al, [d]
0047   0029 B9 00       	cmp al, 0
0048   002B C6 37 00    	jz puts_END
0049   002E 23          	mov ah, al
0050   002F 19 01       	mov al, 1
0051   0031 05 02       	syscall uart_serv
0052   0033 79          	inc d	
0053   0034 0A 28 00    	jmp puts_L1
0054   0037             puts_END:
0055   0037 E7          	pop d
0056   0038 E4          	pop a
0057   0039 EE          	popf
0058   003A             	
0059   003A 09          	ret
0060   003B             	
0061   003B 0A 0D 00    s_nl:			.db "\n\r", 0
0062   003E 43 6F 75 6E s_count:			.db "Count 1 value: ", 0
0062   0042 74 20 31 20 
0062   0046 76 61 6C 75 
0062   004A 65 3A 20 00 
0063   004E             
0064   004E 54 68 69 73 s_help:			.db "This is Process 1. This process is running "
0064   0052 20 69 73 20 
0064   0056 50 72 6F 63 
0064   005A 65 73 73 20 
0064   005E 31 2E 20 54 
0064   0062 68 69 73 20 
0064   0066 70 72 6F 63 
0064   006A 65 73 73 20 
0064   006E 69 73 20 72 
0064   0072 75 6E 6E 69 
0064   0076 6E 67 20 
0065   0079 69 6E 20 70 				.db "in parallel with other processes!\n\r"
0065   007D 61 72 61 6C 
0065   0081 6C 65 6C 20 
0065   0085 77 69 74 68 
0065   0089 20 6F 74 68 
0065   008D 65 72 20 70 
0065   0091 72 6F 63 65 
0065   0095 73 73 65 73 
0065   0099 21 0A 0D 
0066   009C 54 68 65 79 				.db "They share time in a round-robin fashion!\n\n\r", 0
0066   00A0 20 73 68 61 
0066   00A4 72 65 20 74 
0066   00A8 69 6D 65 20 
0066   00AC 69 6E 20 61 
0066   00B0 20 72 6F 75 
0066   00B4 6E 64 2D 72 
0066   00B8 6F 62 69 6E 
0066   00BC 20 66 61 73 
0066   00C0 68 69 6F 6E 
0066   00C4 21 0A 0A 0D 
0066   00C8 00 
0067   00C9             
0068   00C9             
0069   00C9             
0070   00C9             
0071   00C9             
0072   00C9             .endtasm: Number of errors = 0
